---
title: "领域驱动设计"
date: 2025-08-31T13:46:29+08:00
lastmod: 2025-08-31T13:46:29+08:00
author: ["AlfredNing"]
keywords: 
- 
categories: # 没有分类界面可以不填写
- DDD
tags: # 标签
- DDD
description: ""
weight:
slug: ""
draft: false # 是否为草稿
comments: true # 本页面是否显示评论
reward: true # 打赏
mermaid: true #是否开启mermaid
showToc: true # 显示目录
TocOpen: true # 自动展开目录
hidemeta: false # 是否隐藏文章的元信息，如发布日期、作者等
disableShare: true # 底部不显示分享栏
showbreadcrumbs: true #顶部显示路径
cover:
    image: "" #图片路径例如：posts/tech/123/123.png
    caption: "" #图片底部描述
    alt: ""
    relative: false
---

# 概述

领域驱动设计是以业务为核心的软件开发方法论，通过深入理解业务，将业务知识建模为领域模型，最终解决复杂业务场景下的软件开发问题。

```mermaid
graph LR
	业务知识 --> 领域建模 --> 领域模型
```

- 领域专家：产品/运营/最终用户 一切与软件有利益的关系人员

通过战略设计，将大型复杂的系统拆分为相对简单的子域、上下文、达到化整为0的效果。

# 战略设计

## 上下文

业务之间存在的边界。

限界上下文：定于领域模型的边界

上下文映射：定于位于不同上下文模型的关系和协作方式。常见的方式：共享内核/开放主机服务/防腐层等

## 精炼

核心模型构成核心子域，其余的限界上下文构成非核心子域。

非核心子域划分：

- 支撑子域
- 通用子域

## 模块设计图

![image-20250901073138350](https://nq-bucket.oss-cn-shanghai.aliyuncs.com/note_img/image-20250901073138350.png)

# 领域对象的生命周期

![image-20250831150011848](https://nq-bucket.oss-cn-shanghai.aliyuncs.com/note_img/image-20250831150011848.png)

# 实体和值对象

实体: 业务知识进行领域建模，在业务上具备连续性与唯一性的一类领域模型，具有唯一标识

值对象：业务领域建模，没有唯一性与连续性，不具备唯一标识，一般为不可变对象。属性要求不可变。

Dp(Domain Primitive): 领域内的基本数据类型，将领域的隐藏概念显示抽取建模成对象。

## 实体的创建

1. 创建过程原子
2.  创建过程所有属性满足业务要求
3. 实体赋予唯一标识

factory创建实体

## 实体的重建

1. 通过Repository完成

## 值对象的创建

创建过程一旦结束不能对属性进行修改或者重新复制，如果需 求，产生新值对象。

1. 通过构造器
2. 通过Factory模式
3. 通过Builder模式

# 聚合与聚合根

- 所有实体都是聚合，单个实体也是聚合
- 聚合是一致性的边界

聚合是一组对象组成，对象形成了对象树。对象树的根对象称为聚合根。

- 聚合根才拥有repository，非聚合根实体不具备Repository

## 聚合设计的原则

1. 设计小而全的聚合
2. 通过唯一标识引用其他聚合根
3. 一个事务只更新单个聚合
4. 跨聚合采用最终一致性

# Factory 

复杂的领域对象采用工厂设计设计思路

- 创建过程是原子性的
- 创建之后的领域对象包含其必要的属性
- 创建完成的对象符合业务规则

主要完成领域对象从无到有的生产，例如创建

# Repository

- 负责聚合根持久化到数据库
- 负责根据聚合根加载领域对象
- 数据库事务控制

# 领域服务

领域中的某个操作涉及多个聚合根，定义独立的接口来完成此项功能，该接口称为领域服务。

特点：

1. 操作无法归属于实体或值对象
2. 根据操作来命名服务
3. 领域服务是无状态的

## 领域服务与应用服务区别

领域服务属于领域层，属于领域模型的一部分。

应用服务属于应用层，负责定义业务用例并协调业务用例的整体流程，同时协调领域层与基础设施层来完成业务操作，不了解业务的具体细节。

# 防腐层

